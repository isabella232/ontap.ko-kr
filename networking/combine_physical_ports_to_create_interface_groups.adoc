---
sidebar: sidebar 
permalink: networking/combine_physical_ports_to_create_interface_groups.html 
keywords: combine, ports, ifgrp, interface, group, create, creating, add, adding, types, single-mode, single, mode, static, dynamic, multimode, best, practice, port-based, port, based, load, balance, balancing, ip, address, mac, sequential, remove, removing, delete, deleting, combine physical ports to create interface groups, interface group types, characteristics of single-mode interface groups, characteristics of static multimode interface groups, dynamic multimode interface group, load balancing in multimode interface groups, port-based load balancing, ip address and mac address load balancing, sequential load balancing, create an interface group, add a port to an interface group, remove a port from an interface group, delete an interface group 
summary: 두 개 이상의 물리적 포트를 단일 논리 포트로 결합하여 인터페이스 그룹을 생성합니다 
---
= 물리적 포트를 결합하여 인터페이스 그룹을 생성합니다
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
LAG(Link Aggregation Group)라고도 하는 인터페이스 그룹은 동일한 노드에 있는 두 개 이상의 물리적 포트를 단일 논리 포트로 결합하여 생성됩니다. 논리 포트는 향상된 복구 성능, 향상된 가용성 및 로드 공유를 제공합니다.



== 인터페이스 그룹 유형입니다

스토리지 시스템에서는 단일 모드, 정적 멀티모드 및 동적 멀티모드 등 세 가지 유형의 인터페이스 그룹이 지원됩니다. 각 인터페이스 그룹은 서로 다른 수준의 내결함성을 제공합니다. 다중 모드 인터페이스 그룹은 네트워크 트래픽의 로드 밸런싱을 위한 방법을 제공합니다.



=== 단일 모드 인터페이스 그룹의 특성

단일 모드 인터페이스 그룹에서는 인터페이스 그룹에 있는 인터페이스 중 하나만 활성화됩니다. 다른 인터페이스는 대기 상태이며 활성 인터페이스가 실패한 경우 대신 사용할 수 있습니다.

단일 모드 인터페이스 그룹의 특징:

* 페일오버의 경우 클러스터에서 액티브 링크를 모니터링하고 페일오버를 제어합니다. 클러스터가 액티브 링크를 모니터링하므로 스위치 구성이 필요하지 않습니다.
* 단일 모드 인터페이스 그룹에서 대기 중인 인터페이스가 두 개 이상 있을 수 있습니다.
* 단일 모드 인터페이스 그룹이 여러 스위치에 걸쳐 있는 경우 ISL(Inter-Switch Link)을 사용하여 스위치를 연결해야 합니다.
* 단일 모드 인터페이스 그룹의 경우 스위치 포트는 동일한 브로드캐스트 도메인에 있어야 합니다.
* 소스 주소가 0.0.0.0인 링크 모니터링 ARP 패킷은 포트를 통해 전송되어 포트가 동일한 브로드캐스트 도메인에 있는지 확인합니다.


다음 그림은 단일 모드 인터페이스 그룹의 예입니다. 그림에서 e0a 및 E1A는 a0a 단일 모드 인터페이스 그룹의 일부입니다. 활성 인터페이스인 e0a에 장애가 발생하면 대기 E1A 인터페이스가 스위치 연결을 대신 사용합니다.

image:ontap_nm_image6.png["단일 모드 인터페이스 그룹의 이미지입니다"]


NOTE: 단일 모드 기능을 수행하려면 페일오버 그룹을 사용하는 것이 좋습니다. 페일오버 그룹을 사용하면 다른 LIF에 두 번째 포트를 계속 사용할 수 있으며 사용하지 않은 상태로 둘 필요가 없습니다. 또한 페일오버 그룹은 2개 이상의 포트에 걸쳐 있을 수 있으며 여러 노드의 포트를 포괄할 수 있습니다.



=== 정적 멀티모드 인터페이스 그룹의 특성

ONTAP의 정적 멀티모드 인터페이스 그룹 구현은 IEEE 802.3ad(정적)를 준수합니다. 집계를 지원하지만 집계를 구성하기 위한 제어 패킷 교환이 없는 스위치는 정적 멀티모드 인터페이스 그룹과 함께 사용할 수 있습니다.

정적 멀티모드 인터페이스 그룹은 LACP(Link Aggregation Control Protocol)라고도 하는 IEEE 802.3ad(동적)를 준수하지 않습니다. LACP는 Cisco의 독점 링크 통합 프로토콜인 PAgP(Port Aggregation Protocol)와 동일합니다.

다음은 정적 멀티모드 인터페이스 그룹의 특성입니다.

* 인터페이스 그룹의 모든 인터페이스가 활성 상태이고 단일 MAC 주소를 공유합니다.
+
** 여러 개의 개별 연결이 인터페이스 그룹의 인터페이스 간에 분산됩니다.
** 각 연결 또는 세션은 인터페이스 그룹 내에서 하나의 인터페이스를 사용합니다. 순차 로드 밸런싱 체계를 사용하면 모든 세션이 패킷 단위로 사용 가능한 링크 전체에 분산되며 인터페이스 그룹의 특정 인터페이스에 바인딩되지 않습니다.


* 정적 멀티모드 인터페이스 그룹은 최대 "n-1" 인터페이스의 오류에서 복구할 수 있습니다. 여기서 n은 인터페이스 그룹을 구성하는 총 인터페이스 수입니다.
* 포트에 장애가 발생하거나 연결이 끊어지면 장애가 발생한 링크를 통과하는 트래픽이 나머지 인터페이스 중 하나에 자동으로 재분배됩니다.
* 정적 멀티모드 인터페이스 그룹은 링크 손실을 감지할 수 있지만 연결 및 성능에 영향을 줄 수 있는 클라이언트 또는 스위치 구성 오류로 인한 연결 손실을 감지할 수 없습니다.
* 정적 멀티모드 인터페이스 그룹에는 여러 스위치 포트를 통한 Link Aggregation을 지원하는 스위치가 필요합니다. 인터페이스 그룹의 링크가 연결되는 모든 포트가 단일 논리 포트에 속하도록 스위치가 구성됩니다. 일부 스위치는 점보 프레임에 구성된 포트의 링크 집계를 지원하지 않을 수 있습니다. 자세한 내용은 스위치 공급업체의 설명서를 참조하십시오.
* 정적 멀티모드 인터페이스 그룹의 인터페이스 간에 트래픽을 분산하기 위해 몇 가지 로드 밸런싱 옵션을 사용할 수 있습니다.


다음 그림은 정적 멀티모드 인터페이스 그룹의 예입니다. 인터페이스 e0a, E1A, e2a 및 e3a는 A1A 다중 모드 인터페이스 그룹의 일부입니다. A1A 멀티모드 인터페이스 그룹의 4개 인터페이스가 모두 활성화됩니다.

image:ontap_nm_image7.png["정적 멀티모드 인터페이스 그룹의 이미지입니다"]

단일 통합 링크의 트래픽을 여러 물리적 스위치에 분산하는 여러 기술이 존재합니다. 이 기능을 지원하는 데 사용되는 기술은 네트워킹 제품에 따라 다릅니다. ONTAP의 정적 멀티모드 인터페이스 그룹은 IEEE 802.3 표준을 준수합니다. 특정 다중 스위치 링크 통합 기술이 IEEE 802.3 표준과 상호 운용되거나 이를 준수한다고 말한다면 ONTAP와 함께 작동해야 합니다.

IEEE 802.3 표준에는 집계된 링크의 전송 장치가 전송할 물리적 인터페이스를 결정한다고 명시되어 있습니다. 따라서 ONTAP는 아웃바운드 트래픽을 분산하는 데만 책임이 있으며 인바운드 프레임이 도착하는 방식을 제어할 수 없습니다. 집계된 링크에서 인바운드 트래픽의 전송을 관리 또는 제어하려면 직접 연결된 네트워크 장치에서 해당 전송을 수정해야 합니다.



=== 동적 멀티모드 인터페이스 그룹

동적 멀티모드 인터페이스 그룹은 직접 연결된 스위치에 그룹 구성원을 전달하기 위해 링크 통합 제어 프로토콜(LACP)을 구현합니다. LACP를 사용하면 링크 상태 손실과 노드가 직접 연결 스위치 포트와 통신할 수 없음을 감지할 수 있습니다.

ONTAP의 동적 멀티모드 인터페이스 그룹 구현은 IEEE 802.3 AD(802.1 AX)를 준수합니다. ONTAP는 Cisco의 독점 링크 집계 프로토콜인 PAgP(포트 집계 프로토콜)를 지원하지 않습니다.

동적 멀티모드 인터페이스 그룹에는 LACP를 지원하는 스위치가 필요합니다.

ONTAP는 활성 모드 또는 수동 모드로 구성된 스위치와 잘 작동하는 구성 불가능한 활성 모드에서 LACP를 구현합니다. ONTAP는 IEEE 802.3 AD(802.1ax)에 지정된 대로 긴 LACP 타이머 및 짧은 LACP 타이머(구성 불가능한 값 3초 및 90초용)를 구현합니다.

ONTAP 로드 밸런싱 알고리즘은 아웃바운드 트래픽 전송에 사용할 구성원 포트를 결정하며 인바운드 프레임 수신 방식을 제어하지 않습니다. 스위치는 스위치의 포트 채널 그룹에 구성된 로드 밸런싱 알고리즘에 따라 전송에 사용할 포트 채널 그룹의 구성원(개별 물리적 포트)을 결정합니다. 따라서 스위치 구성에 따라 트래픽을 수신할 스토리지 시스템의 구성원 포트(개별 물리적 포트)가 결정됩니다. 스위치 구성에 대한 자세한 내용은 스위치 공급업체의 설명서를 참조하십시오.

개별 인터페이스에서 연속적인 LACP 프로토콜 패킷을 수신하지 못하면 해당 개별 인터페이스는 "ifgrp status" 명령 출력에서 "lag_inactive"로 표시됩니다. 기존 트래픽은 나머지 활성 인터페이스로 자동으로 재라우팅됩니다.

동적 멀티모드 인터페이스 그룹을 사용할 때 다음 규칙이 적용됩니다.

* 동적 멀티모드 인터페이스 그룹은 포트 기반, IP 기반, MAC 기반 또는 라운드 로빈 로드 밸런싱 방법을 사용하도록 구성되어야 합니다.
* 동적 멀티모드 인터페이스 그룹에서 모든 인터페이스는 활성 상태이고 단일 MAC 주소를 공유해야 합니다.


다음 그림은 동적 멀티모드 인터페이스 그룹의 예입니다. 인터페이스 e0a, E1A, e2a 및 e3a는 A1A 다중 모드 인터페이스 그룹의 일부입니다. A1A 동적 멀티모드 인터페이스 그룹의 4개 인터페이스가 모두 활성화됩니다.

image:ontap_nm_image7.png["동적 멀티모드 인터페이스 그룹 이미지"]



=== 다중 모드 인터페이스 그룹의 로드 밸런싱

다중 모드 인터페이스 그룹의 네트워크 포트를 통해 네트워크 트래픽을 균등하게 분배하기 위해 IP 주소, MAC 주소, 순차 또는 포트 기반 로드 밸런싱 방법을 사용하여 다중 모드 인터페이스 그룹의 모든 인터페이스가 나가는 트래픽에 동일하게 활용되도록 할 수 있습니다.

다중 모드 인터페이스 그룹에 대한 로드 밸런싱 방법은 인터페이스 그룹이 생성된 경우에만 지정할 수 있습니다.

* 모범 사례 *: 가능하면 포트 기반 로드 밸런싱이 권장됩니다. 네트워크에서 포트 기반 로드 밸런싱을 사용하는 것이 금지되는 특별한 이유 또는 제한이 없는 경우.



==== 포트 기반 로드 밸런싱

포트 기반 로드 밸런싱이 권장되는 방법입니다.

포트 기반 로드 밸런싱 방법을 사용하여 전송 계층(TCP/UDP) 포트를 기반으로 다중 모드 인터페이스 그룹의 트래픽을 균등화할 수 있습니다.

포트 기반 로드 밸런싱 방법은 전송 계층 포트 번호와 함께 소스 및 대상 IP 주소에 대한 빠른 해싱 알고리즘을 사용합니다.



==== IP 주소 및 MAC 주소 로드 밸런싱

IP 주소 및 MAC 주소 로드 밸런싱은 다중 모드 인터페이스 그룹의 트래픽을 균등하게 조정하는 방법입니다.

이러한 로드 밸런싱 방법은 소스 및 대상 주소(IP 주소 및 MAC 주소)에서 빠른 해싱 알고리즘을 사용합니다. 해싱 알고리즘의 결과가 UP 링크 상태가 아닌 인터페이스에 매핑되면 다음 활성 인터페이스가 사용됩니다.


NOTE: 라우터에 직접 연결하는 시스템에 인터페이스 그룹을 생성할 때 MAC 주소 로드 밸런싱 방법을 선택하지 마십시오. 이러한 설정에서 모든 발신 IP 프레임에 대해 대상 MAC 주소는 라우터의 MAC 주소입니다. 따라서 인터페이스 그룹의 인터페이스가 하나만 사용됩니다.

IP 주소 로드 밸런싱은 IPv4와 IPv6 주소 모두에서 동일한 방식으로 작동합니다.



==== 순차적 로드 밸런싱

순차 로드 밸런싱을 사용하여 라운드 로빈 알고리즘을 사용하여 여러 링크 간에 패킷을 균등하게 분산할 수 있습니다. 순차적 옵션을 사용하여 단일 연결의 트래픽을 여러 링크에서 로드 밸런싱하여 단일 연결 처리량을 높일 수 있습니다.

그러나 순차적 로드 밸런싱으로 인해 순서가 잘못된 패킷 전달이 발생할 수 있기 때문에 성능이 매우 저하될 수 있습니다. 따라서 순차적 로드 밸런싱은 일반적으로 권장되지 않습니다.



== 인터페이스 그룹 또는 LAG를 만듭니다

인터페이스 그룹 또는 LAG(단일 모드, 정적 멀티모드 또는 동적 멀티모드(LACP))를 생성하여 집계된 네트워크 포트의 기능을 결합하여 클라이언트에 단일 인터페이스를 제공할 수 있습니다.

다음 절차는 사용하는 인터페이스에 따라 다릅니다. -- System Manager 또는 CLI:

[role="tabbed-block"]
====
.시스템 관리자
--
* System Manager를 사용하여 LAG * 를 만듭니다

.단계
. LAG를 만들려면 네트워크 > 이더넷 포트 > + Link Aggregation Group * 을 선택합니다.
. 드롭다운 목록에서 노드를 선택합니다.
. 다음 중에서 선택합니다.
+
.. ONTAP to * automatically select broadcast domain (recommended) *.
.. 브로드캐스트 도메인을 수동으로 선택합니다.


. LAG를 구성할 포트를 선택합니다.
. 모드를 선택합니다.
+
.. 단일: 한 번에 하나의 포트만 사용됩니다.
.. 다중: 모든 포트를 동시에 사용할 수 있습니다.
.. LACP: LACP 프로토콜이 사용할 수 있는 포트를 결정합니다.


. 로드 밸런싱 선택:
+
.. IP 기반
.. Mac 기반
.. 포트
.. 순차적


. 변경 사항을 저장합니다.


image:AddLag01.png["지연 그래픽을 추가합니다"]

--
.CLI를 참조하십시오
--
* CLI를 사용하여 인터페이스 그룹을 생성합니다 *

포트 인터페이스 그룹에 적용되는 구성 제한에 대한 전체 목록은 'network port ifgrp add-port' man 페이지를 참조하십시오.

다중 모드 인터페이스 그룹을 생성할 때 다음 로드 밸런싱 방법 중 하나를 지정할 수 있습니다.

* 포트 : 네트워크 트래픽은 전송 계층(TCP/UDP) 포트를 기반으로 분산됩니다. 이것은 권장되는 로드 밸런싱 방법입니다.
* MAC 주소 기준으로 네트워크 트래픽이 분산된다.
* IP: 네트워크 트래픽은 IP 주소를 기반으로 분산됩니다.
* '등전위': 네트워크 트래픽이 수신될 때 분산됩니다.



NOTE: 인터페이스 그룹의 MAC 주소는 기본 포트의 순서 및 부팅 시 이러한 포트가 초기화되는 방식에 따라 결정됩니다. 따라서 재부팅 또는 ONTAP 업그레이드 시 ifgrp MAC 주소가 영구하다고 가정해서는 안 됩니다.

.단계
interface group을 생성하기 위해 'network port ifgrp create' 명령어를 사용한다.

인터페이스 그룹의 이름은 "a<number><letter>" 구문을 사용하여 지정해야 합니다. 예를 들어, a0a, a0b, A1c 및 A2A는 유효한 인터페이스 그룹 이름입니다.

이 명령에 대한 자세한 내용은 를 참조하십시오 link:http://docs.netapp.com/us-en/ontap-cli["ONTAP 9 명령 참조"^].

다음 예에서는 포트 및 다중 모드 분산 기능을 사용하여 a0a라는 인터페이스 그룹을 만드는 방법을 보여 줍니다.

'network port ifgrp create-node_cluster-1-01_-ifgrp_a0a_-Distr-func_port_-mode_multimode_'

--
====


== 인터페이스 그룹 또는 LAG에 포트를 추가합니다

모든 포트 속도에 대해 인터페이스 그룹 또는 LAG에 최대 16개의 물리적 포트를 추가할 수 있습니다.

다음 절차는 사용하는 인터페이스에 따라 다릅니다. -- System Manager 또는 CLI:

[role="tabbed-block"]
====
.시스템 관리자
--
* System Manager를 사용하여 LAG*에 포트를 추가합니다

.단계
. LAG를 편집하려면 * 네트워크 > 이더넷 포트 > LAG * 를 선택합니다.
. LAG에 추가할 같은 노드의 추가 포트를 선택합니다.
. 변경 사항을 저장합니다.


--
.CLI를 참조하십시오
--
* CLI를 사용하여 인터페이스 그룹에 포트를 추가합니다 *

.단계
인터페이스 그룹에 네트워크 포트를 추가합니다.

'network port ifgrp add-port'를 참조하십시오

이 명령에 대한 자세한 내용은 를 참조하십시오 link:http://docs.netapp.com/us-en/ontap-cli["ONTAP 9 명령 참조"^].

다음 예에서는 a0a라는 인터페이스 그룹에 e0c 포트를 추가하는 방법을 보여줍니다.

'network port ifgrp add-port-node_cluster-1-01_-ifgrp_a0a_-port_e0c_'

ONTAP 9.8부터 인터페이스 그룹은 인터페이스 그룹에 첫 번째 물리적 포트가 추가된 후 약 1분 후에 적절한 브로드캐스트 도메인에 자동으로 배치됩니다. ONTAP가 이 작업을 수행하지 않도록 하고 ifgrp를 브로드캐스트 도메인에 수동으로 배치하려는 경우에는 '-skip-broadcast-domain-placement' 매개 변수를 'ifgrp add-port' 명령의 일부로 지정합니다.

--
====


== 인터페이스 그룹 또는 LAG에서 포트를 제거합니다

인터페이스 그룹의 마지막 포트가 아닌 경우 LIF를 호스팅하는 인터페이스 그룹에서 포트를 제거할 수 있습니다. 인터페이스 그룹에서 마지막 포트를 제거하지 않는 점을 고려할 때 인터페이스 그룹이 LIF를 호스팅하거나 인터페이스 그룹이 LIF의 홈 포트가 아니어야 합니다. 그러나 마지막 포트를 제거하는 경우 먼저 인터페이스 그룹에서 LIF를 마이그레이션하거나 이동해야 합니다.

.이 작업에 대해
인터페이스 그룹 또는 LAG에서 최대 16개의 포트(물리적 인터페이스)를 제거할 수 있습니다.

다음 절차는 사용하는 인터페이스에 따라 다릅니다. -- System Manager 또는 CLI:

[role="tabbed-block"]
====
.시스템 관리자
--
* 시스템 관리자를 사용하여 LAG*에서 포트를 제거합니다

.단계
. LAG를 편집하려면 * 네트워크 > 이더넷 포트 > LAG * 를 선택합니다.
. LAG에서 제거할 포트를 선택합니다.
. 변경 사항을 저장합니다.


--
.CLI를 참조하십시오
--
* CLI를 사용하여 인터페이스 그룹에서 포트를 제거합니다 *

.단계
인터페이스 그룹에서 네트워크 포트 제거:

'network port ifgrp remove-port

다음 예는 a0a라는 인터페이스 그룹에서 포트 e0c를 제거하는 방법을 보여줍니다.

'network port ifgrp remove-port-node_cluster-1-01_-ifgrp_a0a_-port_e0c_'

--
====


== 인터페이스 그룹 또는 LAG를 삭제합니다

기본 물리적 포트에서 직접 LIF를 구성하거나 인터페이스 그룹, LAG 모드 또는 배포 기능을 변경하려는 경우 인터페이스 그룹 또는 LAG를 삭제할 수 있습니다.

.시작하기 전에
* 인터페이스 그룹 또는 LAG가 LIF를 호스팅하지 않아야 합니다.
* 인터페이스 그룹 또는 LAG는 LIF의 홈 포트나 페일오버 타겟이 아니어야 합니다.


다음 절차는 사용하는 인터페이스에 따라 다릅니다. -- System Manager 또는 CLI:

[role="tabbed-block"]
====
.시스템 관리자
--
* 시스템 관리자를 사용하여 LAG * 를 삭제합니다

.단계
. LAG를 삭제하려면 * 네트워크 > 이더넷 포트 > LAG * 를 선택합니다.
. 제거할 LAG를 선택합니다.
. LAG를 삭제합니다.


--
.CLI를 참조하십시오
--
* CLI를 사용하여 인터페이스 그룹을 삭제합니다 *

.단계
interface group을 삭제하려면 network port ifgrp delete 명령을 사용한다.

이 명령에 대한 자세한 내용은 를 참조하십시오 link:http://docs.netapp.com/us-en/ontap-cli["ONTAP 9 명령 참조"^].

다음 예에서는 a0b라는 인터페이스 그룹을 삭제하는 방법을 보여줍니다.

'network port ifgrp delete-node_cluster-1-01_-ifgrp_a0b_'

--
====